# Cell Colocalization Counting

This repository provides tools for quantifying colocalized cells expressing various fluorescent proteins, including lcn2, rfp, tdt, spc, and dapi. The primary script, `./python_scripts/run_cell_count_set_sections.py`, utilizes scikit-image to compute the number of cells expressing each fluorescent marker.

### Analysis Workflow

#### Cell Counting:

To account for fluorescence variability across each image, lung images corresponding to individual fluorescent proteins are divided into 9Ã—4 subsections.

For each fluorescent protein:

Image masks are generated by identifying regions of highest fluorescence intensity within each subsection using multi-Otsu thresholding.
These masks are refined by removing small fluorescent regions (< 5 pixels).
Watershed segmentation is then applied to delineate and count individual cells.
Colocalization is assessed by identifying overlaps between masks of different fluorescent proteins.
Subsections are filtered to ensure tissue relevance: any subsection with fewer than 1,000 dapi-positive cells or 10 tdt-positive cells is discarded.

To execute the full analysis, use the following command:

`bash main.sh 'to_process' 'image_dir'`

'to_process' specifies the fluorescent protein to analyze (e.g., 'lcn2', 'krt8', 'rfp').
'image_dir' is the path to the directory containing images for analysis. This directory should include subdirectories for each individual, with separate images for each fluorescent protein.

#### Data Visualization:
Summary boxplots showing colocalization percentages are generated using the following RMarkdown scripts:

`./Rscripts/lcn2_count_summary.Rmd`
`./Rscripts/rfp_count_summary.Rmd`
